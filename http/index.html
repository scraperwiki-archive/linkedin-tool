<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>LinkedIn creeper tool</title>
    <meta http-equiv="cleartype" content="on">
    <link rel="stylesheet" href="vendor/css/bootstrap.min.css">
    <link rel="stylesheet" href="vendor/css/scraperstrap.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>

    <script src="https://x.scraperwiki.com/js/scraperwiki.js"></script>
    <script src="vendor/js/bootstrap.min.js"></script>
    <script src="vendor/js/jquery-io.js"></script>
    <script src="http://coffeescript.org/extras/coffee-script.js"></script>
  </head>
  <body>
     <div class="settings" id="settings-auth">
         <h2>Permission needed from LinkedIn</h2>
         <p>To import your data, please
         <button class="btn btn-primary" type="button" id="authenticate">Authenticate</button> with LinkedIn.
    </div>
    <script type="text/coffeescript">
$ ->
  # cat oauth_keys from box
  scraperwiki.exec('cat ~/tool/oauth_keys.json').success (data) ->
    keys = JSON.parse data
    client_id = keys.apiKey
    scraperwiki.tool.getURL (url) ->
      params =
        response_type: 'code'
        client_id: client_id
        state: 'abc'
        redirect_uri: url
      qs = $.io.object(params).query()
      $('#authenticate').on 'click', ->
        target = "https://www.linkedin.com/uas/oauth2/authorization?#{qs}"
        scraperwiki.tool.redirect target

        </script>

      </body>
</html>
